import{o as c,c as u,a as n,w,v as C,b as g,t as m,d,F as h,r as p,n as f,e as P,f as S,g as A}from"./vendor.5f460242.js";const k=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function i(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerpolicy&&(r.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?r.credentials="include":o.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(o){if(o.ep)return;o.ep=!0;const r=i(o);fetch(o.href,r)}};k();class b{constructor(t,i){this.lat=t,this.lng=i}}class _{constructor(t,i,a,o,r,s,l,y,v){this.location=t,this.googleId=i,this.name=a,this.imgSrc=o,this.rating=r,this.priceClass=s,this.userRatings=l,this.address=y,this.photos=v}}var B=(e,t)=>{const i=e.__vccOpts||e;for(const[a,o]of t)i[a]=o;return i};const L={emits:["addPub"],data:function(){return{pubs:[],originPosition:null,defaultPubPic:"",chosenArray:[],viewPubs:!1,map:null,googleSearchService:null,googleGeoCoder:null,directionsRenderer:new google.maps.DirectionsRenderer({preserveViewport:!0}),directionsService:new google.maps.DirectionsService,pubListVisible:!0,theme:"minimized",divList:"show-potentials",nearyouTheme:"closed",chosenTheme:"closed",popupTheme:!0,ifRating:!0,ifPriceClass:!0,ifImage:!0,globalPopup:_,getNextPage:null,x:new Array(3),counter:0,previousButton:document.querySelector("#previousButton"),nextButton:document.querySelector("#nextButton"),lastAddress:null}},mounted:function(){previousButton.disabled=!0;for(var e=0;e<this.x.length;e++)this.x[e]=new Array;if(this.initMap(),this.geoLocate(),localStorage.getItem("chosenArray"))try{this.chosenArray=JSON.parse(localStorage.getItem("chosenArray"))}catch{localStorage.removeItem("chosenArray")}},watch:{chosenArray:{handler(e){const t=JSON.stringify(e);localStorage.setItem("chosenArray",t),console.log(this.chosenArray),console.log(this.newChosenArray)},deep:!0}},methods:{initMap(){this.map=new google.maps.Map(document.getElementById("map"),{zoom:14,disableDefaultUI:!0,fullscreenControl:!0}),this.directionsRenderer.setMap(this.map),this.googleSearchService=new google.maps.places.PlacesService(this.map),this.googleGeoCoder=new google.maps.Geocoder},async searchByName(){let e={address:this.placeName};this.googleGeoCoder.geocode(e,i);const t=this;function i(a,o){if(o=="OK"){const r=a[0].geometry.location;t.searchByGeoLocation(r),document.querySelector(".switch-button").textContent="Pubs near "+t.placeName,t.resetPageButtons()}else t.notifyUser("No place found")}},async searchByGeoLocation(e){let t={radius:"3000",location:e,type:"bar"};this.googleSearchService.textSearch(t,a);const i=this;function a(o,r,s){if(i.pubs=[],r==google.maps.places.PlacesServiceStatus.OK){for(var l=0;l<o.length;l++){const y=new b(o[l].geometry.location.lat(),o[l].geometry.location.lng()),v="photos"in o[l]?o[l].photos[0].getUrl({maxHeight:1e3}):i.defaultPubPic;i.pubs.push(new _(y,o[l].place_id,o[l].name,v,o[l].rating,o[l].price_level,o[l].user_ratings_total,o[l].formatted_address))}s&&s.hasNextPage?i.getNextPage=()=>{s.nextPage(),i.counter++,console.log(i.counter)}:i.getNextPage=null,i.nearYouButton()}for(var l=0;l<i.pubs.length;l++)i.x[i.counter].push(i.pubs[l]);console.log(i.x)}this.moveMapTo(e)},moveMapTo(e){this.map.panTo(e)},addPub(e){for(let t of this.chosenArray)if(t.name===e.name){this.notifyUser("Pub already added");return}this.chosenArray.push(e),this.notifyUser("Pub added to crawl list")},removePub(e){for(var t=0;t<this.chosenArray.length;t++)this.chosenArray[t]===e&&this.chosenArray.splice(t,1)},async calculateAndDispalyRoutes(e=!1){const t=[];for(let a=1;a<this.chosenArray.length-1;a++)t.push({location:{placeId:this.chosenArray[a].googleId},stopover:!0});const i=this;this.directionsService.route({origin:{placeId:this.chosenArray[0].googleId},destination:{placeId:this.chosenArray[this.chosenArray.length-1].googleId},waypoints:t,optimizeWaypoints:e,travelMode:google.maps.TravelMode.WALKING}).then(a=>{if(e)for(let o=1;o<a.geocoded_waypoints.length-1;o++){let r=i.chosenArray.findIndex(s=>s.googleId===a.geocoded_waypoints[o].place_id);i.moveItem(r,o)}for(let o=0;o<a.routes[0].legs.length;o++)a.routes[0].legs[o].end_address=i.chosenArray[o+1].name,a.routes[0].legs[o].start_address=i.chosenArray[o].name,i.chosenArray[o+1].distance=a.routes[0].legs[o].distance.text;this.directionsRenderer.setDirections(a)})},geoLocate(){var e=this;function t(a){a=new b(a.coords.latitude,a.coords.longitude),e.originPosition=a,e.moveMapTo(a),e.searchByGeoLocation(a)}function i(){e.notifyUser("Unable to retrieve your location")}navigator.geolocation?(navigator.geolocation.getCurrentPosition(t,i),document.querySelector(".switch-button").textContent="Pubs near you",this.resetPageButtons()):notifyUser("Geolocation is not supported by your browser")},showAndHidePubs(){this.pubListVisible===!0?(document.querySelector("#show-hide").textContent="HIDE",this.theme="maximized",this.pubListVisible=!1):(document.querySelector("#show-hide").textContent="SHOW",this.theme="minimized",this.pubListVisible=!0)},forceShowPubs(){document.querySelector("#show-hide").textContent="HIDE",this.theme="maximized",this.pubListVisible=!1},nearYouButton(){this.forceShowPubs(),this.divList="show-potentials",document.querySelector("#response-list").classList.add("selected-list"),document.querySelector("#chosen-list").classList.remove("selected-list"),document.querySelectorAll("#chosen-list .menuButton").forEach(e=>e.classList.add("hidden")),document.querySelectorAll("#response-list .menuButton").forEach(e=>e.classList.remove("hidden")),this.chosenTheme="closed",this.nearyouTheme="open"},chosenButton(){this.forceShowPubs(),this.divList="show-chosenones",document.querySelector("#response-list").classList.remove("selected-list"),document.querySelector("#chosen-list").classList.add("selected-list"),document.querySelectorAll(".menuButton").forEach(e=>e.classList.remove("hidden")),document.querySelectorAll("#response-list .menuButton").forEach(e=>e.classList.add("hidden")),this.chosenTheme="open",this.nearyouTheme="closed"},notifyUser(e){const t=document.querySelector("#notification");t.classList.add("animate"),t.textContent=e,setTimeout(function(){t.classList.remove("animate"),t.textContent=""},3e3)},showPopup(e){this.globalPopup=e,this.popupTheme=!1,e.userRatings==0&&(this.ifRating=!1),e.priceClass==null&&(this.ifPriceClass=!1),e.imgSrc==""&&(this.ifImage=!1)},hidePopup(){this.popupTheme=!0,this.ifRating=!0,this.ifPriceClass=!0,this.ifImage=!0},moveItem(e,t){const i=this.chosenArray.splice(e,1)[0];this.chosenArray.splice(t,0,i)},moveUp(e){const t=this.chosenArray.indexOf(e);t!=0&&this.moveItem(t,t-1)},moveDown(e){const t=this.chosenArray.indexOf(e);t!==this.chosenArray.length&&this.moveItem(t,t+1)},previousPage(){this.counter--,console.log(this.counter),this.counter<2?nextButton.disabled=!1:nextButton.disabled=!0,this.counter>0?previousButton.disabled=!1:previousButton.disabled=!0},nextPage(){this.x[this.counter+1].length>0?this.counter++:this.getNextPage&&this.getNextPage(),this.counter>0?previousButton.disabled=!1:previousButton.disabled=!0,this.counter<2?nextButton.disabled=!1:nextButton.disabled=!0},resetPageButtons(){console.log(this.x),this.counter=0;for(var e=0;e<this.x.length;e++)this.x[e]=[];nextButton.disabled=!1,previousButton.disabled=!0,console.log(this.x)}}},I=n("section",{id:"map-container"},[n("div",{id:"map"})],-1),N={id:"search-section"},x={id:"search-box"},q={id:"search-form"},T=n("div",{id:"notification"},null,-1),R={key:0,id:"popup-section"},M={class:"popup"},O={key:0},D={key:1,class:"starDiv"},U=P(" Price class: "),V=n("strong",null,"$",-1),E=[V],G=n("strong",null,"$",-1),z=[G],H=n("hr",null,null,-1),$={key:2},F={key:3,class:"starDiv"},W=P(" Rating: "),Y=n("span",{class:"fa fa-star checked"},null,-1),j=[Y],K=n("span",{id:"star-not-checked",class:"fa fa-star"},null,-1),J=[K],Z=["src"],Q={key:5,src:"https://as2.ftcdn.net/v2/jpg/02/55/54/87/1000_F_255548787_NN93IpmZ29kRmNfy8OYWvSqLYSm1VCTj.jpg"},X={id:"response-list",class:"list"},ee={class:"icon-name"},te={key:0,class:"searchbar-button material-icons md48 beer-colored"},oe=["onClick"],se=["onClick"],ne={id:"chosen-list",class:"list"},ie={id:"switch-buttons"},re=["onClick"],ae={class:"order-pubs"},le=["onClick"],ce=["onClick"],ue=["onClick"];function de(e,t,i,a,o,r){return c(),u(h,null,[I,n("section",N,[n("div",x,[n("form",q,[w(n("input",{id:"search-field",type:"search",placeholder:"Find you target town","onUpdate:modelValue":t[0]||(t[0]=s=>e.placeName=s)},null,512),[[C,e.placeName]]),n("button",{onClick:t[1]||(t[1]=g(s=>r.searchByName(),["prevent"])),id:"search-button",class:"searchbar-button material-icons md48 beer-colored"}," sports_bar "),n("button",{onClick:t[2]||(t[2]=g(s=>r.geoLocate(),["prevent"])),class:"searchbar-button material-icons md24 beer-colored"}," my_location ")])]),T]),e.popupTheme?d("",!0):(c(),u("section",R,[n("div",M,[n("button",{class:"popup-close-button",onClick:t[3]||(t[3]=s=>r.hidePopup(e.result))},"\u2716"),n("p",null,[n("strong",null,m(e.globalPopup.name),1)]),n("p",null,m(e.globalPopup.address),1),e.ifPriceClass?d("",!0):(c(),u("div",O,"No price class...")),e.ifPriceClass?(c(),u("div",D,[U,(c(!0),u(h,null,p(Math.round(e.globalPopup.priceClass),s=>(c(),u("div",{class:"price-class-a",key:s},E))),128)),(c(!0),u(h,null,p(5-Math.round(e.globalPopup.priceClass),s=>(c(),u("div",{key:s,class:"price-class-b"},z))),128))])):d("",!0),H,e.ifRating?d("",!0):(c(),u("div",$,"No rating...")),e.ifRating?(c(),u("div",F,[W,(c(!0),u(h,null,p(Math.floor(e.globalPopup.rating),s=>(c(),u("div",{key:s},j))),128)),(c(!0),u(h,null,p(5-Math.floor(e.globalPopup.rating),s=>(c(),u("div",{key:s},J))),128))])):d("",!0),n("p",null,"Number of ratings: "+m(e.globalPopup.userRatings),1),e.ifImage?(c(),u("img",{key:4,src:e.globalPopup.imgSrc},null,8,Z)):d("",!0),e.ifImage?d("",!0):(c(),u("img",Q))])])),n("section",{id:"list-section",class:f(e.theme)},[n("div",{id:"show-hide",class:"beer-colored",onClick:t[4]||(t[4]=s=>r.showAndHidePubs())}," SHOW "),n("div",{id:"div-list",class:f(e.divList)},[n("div",X,[n("button",{class:"switch-button",onClick:t[5]||(t[5]=s=>r.nearYouButton(this))}," Pubs near you "),n("ul",null,[(c(!0),u(h,null,p(e.x[e.counter],s=>(c(),u("li",{key:s.name,class:f(e.nearyouTheme),"aria-haspopup":"true"},[n("div",ee,[e.chosenArray.includes(s)?(c(),u("i",te,"done")):d("",!0),n("p",{class:"li-name",onClick:l=>r.showPopup(s)},m(s.name),9,oe)]),n("button",{class:"add-remove-button",onClick:l=>r.addPub(s)},"+",8,se)],2))),128))]),n("div",null,[n("button",{onClick:t[6]||(t[6]=s=>r.previousPage()),id:"previousButton",class:"menuButton"}," Previous "),n("button",{onClick:t[7]||(t[7]=s=>r.nextPage()),id:"nextButton",class:"menuButton"}," Next ")])]),n("div",ne,[n("div",ie,[n("button",{id:"switch-1",class:"switch-button",onClick:t[8]||(t[8]=s=>r.chosenButton())}," Planned Crawl "),n("button",{id:"switch-2",class:"menuButton hidden",type:"button",onClick:t[9]||(t[9]=g(s=>r.calculateAndDispalyRoutes(!1),["prevent"]))}," Show Route "),n("button",{id:"switch-3",class:"menuButton hidden",type:"button",onClick:t[10]||(t[10]=g(s=>r.calculateAndDispalyRoutes(!0),["prevent"]))}," Optimize Route ")]),n("ul",null,[(c(!0),u(h,null,p(e.chosenArray,s=>(c(),u("li",{key:s.name,class:f(e.chosenTheme)},[n("p",{onClick:l=>r.showPopup(s)},m(s.name),9,re),n("div",ae,[n("span",{class:"material-icons",onClick:l=>r.moveUp(s)},"expand_less",8,le),n("span",{class:"material-icons",onClick:l=>r.moveDown(s)},"expand_more",8,ce)]),n("button",{class:"add-remove-button",onClick:l=>r.removePub(s)}," - ",8,ue)],2))),128))])])],2)],2)],64)}var he=B(L,[["render",de]]);const pe={data:function(){return{}},methods:{}},me=Object.assign(pe,{setup(e){return(t,i)=>(c(),S(he))}});A(me).mount("#app");
